---
layout: default
title: Amazon S3 Guide
---

<div class="jumbotron jumbotron-compact">
    <div class="container">
        <h1>
            <a href="/">XerahS</a>
        </h1>
        <p>Amazon S3 Guide</p>
    </div>
</div>

<div class="container">
    <div class="row">
        <div class="col-lg-12">
            <h1>Amazon S3 Setup Guide</h1>
            <p class="lead">This guide focuses on the user steps required to configure Amazon S3 in XerahS. Follow the SSO flow (recommended) or the Access Keys flow.</p>

            <h2 class="mt-4">SSO (IAM Identity Center) - Recommended</h2>
            <ol>
                <li><strong>Enable IAM Identity Center:</strong> AWS Console -> IAM Identity Center -> Enable. Choose and note the Identity Center region.</li>
                <li><strong>Create a permission set:</strong> IAM Identity Center -> Permission sets -> Create. For testing, use <code>AdministratorAccess</code>. For least-privilege, include S3 actions listed below.</li>
                <li><strong>Assign the user:</strong> IAM Identity Center -> AWS accounts -> Select account -> Assign users or groups -> Choose the permission set.</li>
                <li><strong>Find the Start URL:</strong> IAM Identity Center -> Dashboard -> Settings -> AWS access portal URL (looks like <code>https://d-xxxx.awsapps.com/start</code>).</li>
                <li><strong>Open XerahS -> Amazon S3 -> AWS SSO mode:</strong> Enter the Start URL and select Endpoint / Region.</li>
                <li><strong>Step 1 - Start Login:</strong> Click <code>Step 1 - Start Login</code>.</li>
                <li><strong>Step 2 - Approve in browser:</strong> Use the User Code at the Verification URL, then approve access.</li>
                <li><strong>Step 3 - Complete Login:</strong> Click <code>Step 3 - Complete Login</code>.</li>
                <li><strong>Step 4 - Select account and role:</strong> Choose the assigned AWS account and role.</li>
                <li><strong>Step 5 - Refresh Credentials:</strong> Click <code>Step 5 - Refresh Credentials</code> to load role credentials.</li>
                <li><strong>Step 6 - Provision S3:</strong> Click <code>Step 6 - Provision S3</code> to create/update the bucket and apply public settings.</li>
                <li><strong>Step 7 - CNAME target:</strong> Copy the generated CNAME target and add it in your DNS provider.</li>
            </ol>

            <h3 class="mt-4">Recommended Checkbox Defaults (Current UI)</h3>
            <ul>
                <li><code>Make uploads public (public-read ACL)</code>: unchecked</li>
                <li><code>Add public bucket policy (recommended)</code>: checked</li>
                <li><code>Signed payload</code>: checked</li>
            </ul>

            <h3 class="mt-4">Required S3 Permissions (for least-privilege)</h3>
            <ul>
                <li><code>s3:CreateBucket</code>, <code>s3:HeadBucket</code></li>
                <li><code>s3:PutPublicAccessBlock</code></li>
                <li><code>s3:PutBucketPolicy</code> (if using public bucket policy)</li>
                <li><code>s3:PutObject</code>, <code>s3:GetObject</code></li>
            </ul>

            <h2 class="mt-4">Access Keys (Manual)</h2>
            <ol>
                <li><strong>Create IAM user:</strong> Add an IAM user with S3 access, then create Access Key ID and Secret Access Key.</li>
                <li><strong>Open XerahS -> Amazon S3 -> Access Keys mode:</strong> Paste Access Key ID and Secret Access Key.</li>
                <li><strong>Select Bucket + Endpoint:</strong> Choose the bucket and region.</li>
                <li><strong>Optional: Custom Domain:</strong> If using a CNAME, add the DNS record as shown in the app.</li>
                <li><strong>Upload a test file:</strong> Confirm the URL works.</li>
            </ol>

            <h2 class="mt-4">Troubleshooting</h2>
            <ul>
                <li><strong>No accounts/roles appear:</strong> Ensure the user is assigned to an AWS account and permission set in IAM Identity Center.</li>
                <li><strong>AccessDenied when opening file URL:</strong> Enable the public bucket policy option and re-run Provision S3.</li>
                <li><strong>SignatureDoesNotMatch:</strong> Ensure the SSO role has <code>s3:PutBucketPolicy</code> and the selected region is correct.</li>
            </ul>

            <div class="mt-5">
                <a class="btn" href="/">Back to Home</a>
            </div>
        </div>
    </div>
</div>

{% include common-js.html %}
<script src="/js/xerahs.main.js"></script>
